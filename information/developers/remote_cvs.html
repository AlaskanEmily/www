<html>
<head>

<title>The Mercury Project: Remote CVS Access </title>
</head>
<body bgcolor="#ABCDEF" text="#000000">

<h2>Using the CVS client to remotely access the Mercury CVS archive</h2>

Author: Tyson Dowd -- trd@cs.mu.oz.au 
<p>

Almost all work in the Mercury project is under revision control using
CVS.  The sources, documentation, test-cases, webpages and samples
are all stored under various modules of the CVS repository on
filesystems here at the University of Melbourne. CVS allows
client-server access to this repository. This document describes how
to use the CVS archive remotely.
<p>

You need:
<ul>
	<li> A version of CVS with client server support (1.9 works fine)
	  installed at the remote end. Probably anything newer than
	  1.5 will work OK.
	<li> A TCP/IP connection to the Internet.
</ul>

Anonymous Access:
<ul>
	<li> The CVS server is running on <b>hydra.cs.mu.oz.au</b>, and the
	repository is in the directory <b>/home/mercury1/repository</b>
	<li> The anonymous access account is called <i>guest</i> with a
		password of <i>guest</i>
	<li> To login (you need to do this just once)
<pre>
	cvs -d :pserver:guest@hydra.cs.mu.oz.au:/home/mercury1/repository login
</pre>
	<li> The password is <i>guest</i>
	<li> To checkout a module 
<pre>
	cvs -d :pserver:guest@hydra.cs.mu.oz.au:/home/mercury1/repository checkout mercury
</pre>
	<li> There is a list of modules later in this page.

	<li> You will have read-only access to the repository.  If you
	want to commit something you will need to get someone with
	read-write access to do it for you.  If you send your patch to
	the mercury-developers mailing list you should be able to get
	this done.

	<li> You almost certainly want to add the following lines to
	your .cvsrc (in your home directory).

<pre>
	cvs -z6
	diff -u -N
	update -Pd
</pre>

	<li> This turns on compression in client/server transfers, uses
	the preferred Mercury diff format (unified diff with new files
	shown as diffs), prunes empty directories and picks up new
	directories.

	<li> Please remember that if you want to track the latest
	releases, you may run into incompatibility problems unless you
	update very regularly.  The Mercury compiler often relies on a
	very recent version of the Mercury compiler to build from
	scratch.  If you get out of date, it might be worth downloading
	the latest release-of-the-day and installing it.
</ul>

Getting Write Access:
<ul>
	<li> The CVS server uses password authentication. You need to
	  have a password installed in CVS's password file on
	  the server end.  CVS stores your password (only very lightly
	  encrypted) on your machine, so you won't have to remember your
	  password or use it very often after you have logged in the
	  first time.

	<li> Generate a password using standard UNIX /etc/passwd style
	  passwords.  *Do not* use your normal password.  A good way to
	  do this is change your password to something, copy the line
	  from /etc/passwd, then change it back.  If you have htpasswd
	  installed using it is even easier.  Only the username and
	  encrypted password are needed.<p>

	  e.g. myusername:s9FOR1a8DOxDs<p>

	  (If your system uses shadow password files, the password field
	  of /etc/passwd will not be meaningful; mail us if there is a problem).
	  <p>

	  If your encrypted passwd after you change it back looks different 
	  from what it looked like originally, do not worry. The encrypted
	  form of your password depends not only on your password but also
	  on a 16-bit value known as the "salt" that is generated randomly
	  every time you change your password, and which is recorded in
	  the encrypted password field itself.

	<li> Send the line with the username and encrypted password to the
	  Mercury team, who will install it for you. If you have access to
	  the CVS repository at the University of Melbourne, you can just
	  add it to the file /home/mercury1/repository/CVSROOT/passwd.

	<li> Also, tell us what domain you're going to be accessing the
	  repository from, so we can adjust our security setup to allow
	  you access. If you don't say, we'll assume it is the same as your
	  email address. (Mercury team - modify /etc/hosts.allow to
	  allow that domain).

	<li> Access via Windows works just fine.  Most firewalls are
	  setup to allow CVS access through.  You can get a free
	  binary (and source) CVS for Windows from 
	  <a href="http://www.cyclic.com/">www.cyclic.com</a>.
	  Also there is a product called 
	  <a href="http://www.wincvs.com/">WinCVS</a> that should
	  work (although we haven't tried it ourselves).

	<li> There are some checks that are done via questions.  In
	particular, our CVS repository does checks for up-to-date
	copyright messages on all files.  These checks don't work very
	well using the CVS `pserver' as mentioned here -- when you check
	in it will complain that it doesn't know how to interact with
	you.  Contact us if this is a big problem -- we know some
	workarounds.
</ul>

Then (once you've been added to the passwd file):
<ul>

	<li> Set your CVSROOT environment variable to <p>
	<ul>
	  <li>:pserver:username@hydra.cs.mu.oz.au:/home/mercury1/repository
	</ul>

	  <p>
	  Make sure this environment variable is exported (in sh
	  based shells, "export CVSROOT", in csh based shells, use
	  "setenv" to set the environment variable in the first place).

	<li> Run "cvs login" to login to the server for the first time.

	<li> CVS will remember your password from now on (it is rather
	  insecurely stored in a slightly jumbled manner in ~/.cvspass),
	  so you rarely have to login again.

	<li> You can do "cvs co mercury" to check out the main mercury
	  module. This can take a while over a slow connection, but you
	  should see pretty steady progress messages, eg:
	  <pre>
	  	U mercury/.INSTALL.in
		U mercury/.README.in
		U mercury/.cvsignore
		U mercury/BUGS
		U mercury/COPYING
		U mercury/COPYING.LIB
		etc
	  </pre>

	<li> The CVS modules you might need access to are:
		<dl>
	  	<dt>mercury	<dd> the mercury compiler, runtime, library,
				  extras and documentation. (8.9Mb)
	  	<dt>gcc/mercury	<dd> the mercury-gcc distribution;
				  this contains part of the source for the
				  <a href="http://www.mercury.cs.mu.oz.au/download/gcc-backend.html">native code
				  back-end</a>
	  	<dt>tests	<dd> test cases for the compiler (0.72Mb)
		<dt>clpr	<dd> the CLP(R) interface (0.88Mb)
		<dt>w3		<dd> the www page (7.5Mb - lots of papers)
		</dl>

	  CVS should compress most of this stuff while sending it.
</ul>

NOTE:
<ul>
	<li> Developers should subscribe to the mercury-developers mailing
	  list, to keep up-to-date on development discussion, and 
	  to be able to participate in discussions about code they
	  want to change. This is a forum to ask questions about how
	  to change something, discuss design trade-offs, and report
	  on any development that you suspect will influence others.
	  (Traffic is moderately high in this mailing list - between
	  100 and 300 messages per month, so you should filter into
	  a separate folder if possible).

	<li> Before committing any code, read the policy on reviews for the
	  Mercury system. This can be found in the mercury CVS
	  module:
	  <ul>
	  	<li> mercury/compiler/notes/reviews.html
	  </ul>
	  or
	  <ul>
	  	<li>on the <a href="http://www.mercury.cs.mu.oz.au/information/doc/reviews.html">web</a>
	  </ul>
	  Basically, we don't commit broken code into the repository,
	  and we don't commit un-reviewed code.

	<li> You'll need to be familiar with CVS to keep up to date with
	  the development tree. If you haven't used it before, read the
	  info pages on CVS and the documentation that comes with it.
	  There is a free book on CVS at 
	  <a href="http://cvsbook.red-bean.com/">cvsbook.red-bean.com</a>

	<li> If you have any questions, just ask.
</ul>


<p>
<hr>
<p>
Comments? Mail <a href = "mailto:mercury@cs.mu.oz.au">mercury@cs.mu.oz.au</a>,
or see our <a href = "../email.html" >contact</a> page.<br>

Last update was $Date: 2001-08-01 12:12:35 $ by $Author: fjh $@cs.mu.oz.au
</body>
</html>

